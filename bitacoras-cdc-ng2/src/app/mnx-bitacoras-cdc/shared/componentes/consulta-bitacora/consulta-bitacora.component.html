<form *ngIf="tablaOrigen" [formGroup]="formFiltros">
  <div class="ui-g ui-g-nopad">
    <div class="ui-g-12">
      <div class="ui-widget-header ui-helper-clearfix" style="padding:4px 10px;border-bottom: 0 none">
        <div class="ui-g">
          <div class="ui-g-12">
            <button [disabled]="formFiltros.prinstine" class="pull-right" md-tooltip="Descartar filtros" tooltip-position="below" color="primary"
              md-mini-fab (click)="resetFiltros()">
									<md-icon fontSet="fa" fontIcon="fa-filter"></md-icon>
            </button>
          </div>
        </div>
      </div>
      <p-dataTable [value]="registrosBitacora" rows="10" [paginator]="true" [pageLinks]="4" [totalRecords]="totalRegistros" [lazy]="true"
        (onLazyLoad)="loadBitacoraLazy($event)" paginatorPosition="both"
        emptyMessage="No se encontraron datos para su consulta" [rowsPerPageOptions]="[10,20,30]">
        <header>{{tablaOrigen.esquemaTabOrigen}} - {{tablaOrigen.nomTabOrigen}}</header>
        <footer>Total: {{totalRegistros}}</footer>
        <p-column field="OPERACION" [style]="{'overflow': 'visible'}" [sortable]="true">
          <template pTemplate type="header">
            <span>Operación</span>
            <p-dropdown [options]="operacionesSI" formControlName="operacion"></p-dropdown>
          </template>
        </p-column>
        <p-column field="F_CAMBIO" [style]="{'overflow': 'visible'}" [sortable]="true">
          <template pTemplate type="header">
            <span>Fecha del cambio (Rango)</span>
            <div>
              <p-calendar dateFormat="dd/mm/yy" formControlName="finicio" [minDate]="inicioMinDate" [maxDate]="inicioMaxDate" [readonlyInput]="true"
                [locale]="locale"></p-calendar>
              <p-calendar dateFormat="dd/mm/yy" formControlName="ffin" [minDate]="finMinDate" [maxDate]="finMaxDate" [readonlyInput]="true"
                [locale]="locale"></p-calendar>
            </div>
          </template>
        </p-column>
        <p-column field="DES_CAMBIO" [style]="{'overflow': 'visible'}">
          <template pTemplate type="header">
            <span>Descripción del cambio</span>
            <p-autoComplete inputStyleClass="input-full-width" [suggestions]="items | async" (completeMethod)="buscaColumnas($event)"
              [multiple]="true" formControlName="columnas"></p-autoComplete>
            <i *ngIf="buscando" class="fa fa-spiner fa-spin"></i>
          </template>
        </p-column>
        <p-column field="DESCR_USUARIO" [sortable]="true">
          <template pTemplate type="header">
            <span>Usuario que efectuó el cambio</span>
            <input class="input-full-width" type="text" formControlName="descUsuario" pInputText />
          </template>
        </p-column>
        <p-column *ngFor="let col of columnas; let i=index" [field]="col.field" [sortable]="true">
          <template pTemplate type="header">
            <span>{{col.header}}</span>
            <!--<input class="input-full-width" type="text" [formControlName]="i" pInputText />-->
          </template>
        </p-column>
        <p-column field="ID_BITACORA" header="Detalles" [style]="{'text-align':'center'}">
          <template let-reg="rowData" pTemplate type="body">
            <button md-tooltip="Detalles" tooltip-position="below" color="primary" md-mini-fab (click)="consultarDetalles(reg.ID_BITACORA)">
									<md-icon fontSet="fa" fontIcon="fa-search"></md-icon>
								</button>
          </template>
        </p-column>
      </p-dataTable>
    </div>
  </div>
</form>
<mnx-bitacoras-cdc-detalles-bitacora *ngIf="tablaOrigen" [tablaOrigen]="tablaOrigen"></mnx-bitacoras-cdc-detalles-bitacora>